esphome:
  name: ${esphome_name}

text_sensor:
  - platform: version
    name: "Fire Ver"
    id: firmware_version
    on_value:
        then:
          - lvgl.label.update:
              id: lbl_app_name
              text:
                format: "${friendly_name}\n%s"
                args: [ 'id(firmware_version).state.c_str()' ]  
#==========================================================================================================================
font:
  # - file: "gfonts://Roboto@medium"
  - file: 
      fonts/Roboto-Medium.ttf
    id: font_roboto_medium22
    size: 22
    glyphs: '!"%()+,-_.:°0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ abcdefghijklmnopqrstuvwxyz/³µŋ'
    glyphsets:
      - GF_Latin_Core
      - GF_Latin_Plus
      - GF_Greek_Core
      - GF_Cyrillic_Core
#==========================================================================================================================
image:
  - file: https://esphome.io/favicon-512x512.png #relocated to remove _static location ref in url
    id: boot_logo
    resize: 200x200
    type: RGB565
    use_transparency: true
    # transparency: opaque #Changed syntax ESPHome 2025.8.0
#==========================================================================================================================
# Scripts to update bar displays so that either new thresholds or new values trigger the same code


#==========================================================================================================================
lvgl:
  displays:
    - m5stack_display
  encoders:
    enter_button: M5_BtnB
    sensor: 
      left_button: M5_BtnA
      right_button: M5_BtnC
  resume_on_input: true #resume from pause on button press (encoder rotate)
  id: lv_id #Only reqd so that ota can force updates to lvgl display even when main loop not running
#==========================================================================================================================
  gradients:
    - id: color_bar
      direction: hor
      dither: none
      stops:
        - color: 0xFF0000
          position: 0
        - color: 0xFFFF00
          position: 42
        - color: 0x00FF00
          position: 84
        - color: 0x00FFFF
          position: 127
        - color: 0x0000FF
          position: 169
        - color: 0xFF00FF
          position: 212
        - color: 0xFF0000
          position: 255
    - id: blue_red_bar
      direction: hor
      dither: none
      stops:
        - color: blue
          position: 0
        - color: red
          position: 255
    - id: green_blue_bar
      direction: hor
      dither: none
      stops:
        - color: green
          position: 0
        - color: blue
          position: 255

  theme:
    label:
      text_font: montserrat_18 # set all your labels to use your custom defined font
    button:
      bg_color: 0x2F8CD8
      bg_grad_color: 0x005782
      bg_grad_dir: VER
      bg_opa: COVER
      border_color: 0x0077b3
      border_width: 1
      text_color: 0xFFFFFF
      pressed: # set some button colors to be different in pressed state
        bg_color: 0x006699
        bg_grad_color: 0x00334d
      checked: # set some button colors to be different in checked state
        bg_color: 0x1d5f96
        bg_grad_color: 0x03324A
        text_color: 0xfff300
      focused:
#        bg_color: 0x00cc00
        border_color: 0xff0000
#        bg_grad_dir: NONE
        border_width: 4
    buttonmatrix:
      bg_opa: COVER
      # bg_opa: TRANSP
      border_color: 0x0077b3
      border_width: 2 #Must be same border width focussed and non-focussed otherwise buttons shift up from screen bottom when focussed
      text_color: 0xFFFFFF
      pad_all: 0
      focused:
        # bg_color: 0x00cc00
        border_color: 0xff0000
        # bg_grad_dir: NONE
        border_width: 2
      items: # set all your buttonmatrix buttons to use your custom defined styles and font
        bg_color: 0x2F8CD8
        bg_grad_color: 0x005782
        bg_grad_dir: VER
        bg_opa: COVER
        border_color: 0x0077b3
        border_width: 1
        text_color: 0xFFFFFF
        text_font: montserrat_14
        pressed:
          bg_color: 0x006699
          bg_grad_color: 0x00334d
        checked:
          bg_color: 0x1d5f96
          bg_grad_color: 0x03324A
          text_color: 0x005580
        focused:
          bg_color: 0x00cc00
          border_color: 0xff0000
          bg_grad_dir: NONE
          border_width: 2
          border_post: true
    switch:
      bg_color: 0xC0C0C0
      bg_grad_color: 0xb0b0b0
      bg_grad_dir: VER
      bg_opa: COVER
      focused:
        # bg_color: 0x00cc00
        border_color: 0xff0000
        # bg_grad_dir: NONE
        border_width: 2
      checked:
        bg_color: 0x1d5f96
        bg_grad_color: 0x03324A
        bg_grad_dir: VER
        bg_opa: COVER
      knob:
        bg_color: 0xFFFFFF
        bg_grad_color: 0xC0C0C0
        bg_grad_dir: VER
        bg_opa: COVER
    slider:
      border_width: 1
      border_opa: COVER
      bg_color: 0xcccaca
      bg_opa: COVER
      pad_all: 0
      pressed: #Occurs momentarily when changed value is accepted
        border_color: 0xff0000
        # bg_grad_dir: NONE
        border_width: 4
        border_opa: COVER
        bg_color: 0x00cc00 #only affects the background not covered by indicator bar
      focused:
        border_color: 0xff0000
        # bg_grad_dir: NONE
        border_width: 2
        border_opa: COVER
      indicator:
        bg_color: 0x1d5f96
        bg_grad_color: 0x03324A
        bg_grad_dir: VER
        bg_opa: COVER
        focused:
          # bg_color: 0x00cc00
          border_color: 0xff0000
          # bg_grad_dir: NONE
          border_width: 2
      knob:
        bg_color: 0x2F8CD8
        bg_grad_color: 0x005782
        bg_grad_dir: VER
        bg_opa: COVER
        border_color: 0x0077b3
        border_width: 1
        text_color: 0xFFFFFF
        focused:
          bg_color: 0x00cc00
          border_color: 0xff0000
          bg_grad_dir: NONE
          border_width: 2
#==========================================================================================================================
  style_definitions:
    - id: header_footer
      bg_color: 0x2F8CD8
      bg_grad_color: 0x005782
      bg_grad_dir: VER
      bg_opa: COVER
      # border_opa: TRANSP
      border_opa: COVER
      radius: 0
      pad_all: 0
      pad_row: 0
      pad_column: 0
      border_color:  0x0077b3
      text_color: 0xFFFFFF
      width: 100%
      height: 30

    - id: bar_temperature
      bg_opa: TRANSP #COVER
    - id: indicator_temperature
      bg_grad: blue_red_bar
      bg_opa: 50%
    - id: bar_humidity
      bg_opa: TRANSP #COVER
    - id: indicator_humidity
      bg_grad: green_blue_bar
      bg_opa: 50%
    - id: lbl_temperature_humidity
      text_align: RIGHT

  top_layer:
    widgets:
      - label:
          text: "B"
          id: lbl_battery
#          hidden: true
          align: top_right
          x: -22
          y: 7
          text_align: right
          text_color: 0xFFFFFF
      - label:
          text: "\uF1EB"
          id: lbl_hastatus
          hidden: true
          align: top_right
          x: -2
          y: 7
          text_align: right
          text_color: 0xFFFFFF
      - label:
          text: "Time" # Will be overwritten by the time update script
          id: lbl_time
          align: top_left
          x: 2
          y: 7
          text_align: left
          text_color: 0xFFFFFF
      - buttonmatrix:
          align: bottom_mid
          styles: header_footer
          # pad_all: 0
          outline_width: 0
          id: top_layer
          items:
            styles: header_footer
          rows:
            - buttons:
              - id: page_prev
                text: "Prev page"
                on_press:
                  then:
                    lvgl.page.previous:
              - id: page_home
                text: "\uF015"
                on_press:
                  then:
                    lvgl.page.show: main_page
              - id: page_next
                text: "next page"
                on_press:
                  then:
                    lvgl.page.next:
      - obj:
          id: boot_screen
          x: 0
          y: 0
          width: 100%
          height: 100%
          bg_color: 0xffffff
          bg_opa: COVER
          radius: 0
          pad_all: 0
          border_width: 0
          widgets:
            - image:
                align: CENTER
                src: boot_logo
                y: -40
            - spinner:
                align: CENTER
                y: 95
                height: 50
                width: 50
                spin_time: 1s
                arc_length: 60deg
                arc_width: 8
                indicator:
                  arc_color: 0x18bcf2
                  arc_width: 8
            - label: 
                align: CENTER
                y: 60
                id: lbl_boot
                text: "Booting"
          on_press:
            - lvgl.widget.hide: boot_screen
#==========================================================================================================================
  pages:
#==========================================================================================================================
#--------------------------------------------------------------------------
    - id: main_page
      on_load:
        - lvgl.widget.focus: top_layer # focus_next
      bg_color: 0x000000
      widgets:
        - obj: # Title block
            align: TOP_MID
            styles: header_footer
            widgets:
              - label:
                  text: "ESPHome LVGL Display"
                  align: CENTER
                  text_align: CENTER
                  text_color: 0xFFFFFF
        - obj: # a properly placed coontainer object for all these controls
            text_color: 0xFFFFFF
            align: CENTER
            width: 320
            height: 180 #240-(2*30) #Display area less header & footer
            pad_all: 6
            bg_opa: TRANSP
            border_opa: TRANSP
            outline_width: 1 #debug
            layout: # enable the GRID layout for the children widgets
              type: GRID # split the rows and the columns proportionally
              grid_columns: [FR(1), FR(1), FR(1)] # equal
              grid_rows: [FR(1), FR(1), FR(1), FR(1)] # like percents
              pad_row: 6
              pad_column: 8
            widgets:
              - label:
                  grid_cell_column_pos: 0 # place the widget in
                  grid_cell_row_pos: 0 # the corresponding cell
                  grid_cell_column_span: 2 #Span 2 columns as firmware version is a long string
                  grid_cell_x_align: STRETCH
                  grid_cell_y_align: STRETCH
                  id: lbl_app_name
                  text: ${friendly_name}
              - label:
                  grid_cell_column_pos: 0 # place the widget in
                  grid_cell_row_pos: 1 # the corresponding cell
                  grid_cell_x_align: STRETCH
                  grid_cell_y_align: STRETCH
                  id: lbl_wifi_strength
                  text: wifi
              - label:
                  grid_cell_column_pos: 0 # place the widget in
                  grid_cell_row_pos: 2 # the corresponding cell
                  grid_cell_x_align: STRETCH
                  grid_cell_y_align: STRETCH
                  id: lbl_wifi_ssid
                  text: ssid
              - label:
                  grid_cell_column_pos: 0 # place the widget in
                  grid_cell_row_pos: 3 # the corresponding cell
                  grid_cell_x_align: STRETCH
                  grid_cell_y_align: STRETCH
                  id: lbl_wifi_ip
                  text: ip addr
#--------------------------------------------------------------------------
    - id: battery_page
      bg_color: 0x000000 #black
      widgets:
        - obj:
            align: TOP_MID
            styles: header_footer
            widgets:
              - label:
                  text: "Batteries"
                  align: CENTER
                  text_align: CENTER
                  text_color: 0xFFFFFF #white
        - obj: # a properly placed coontainer object for all these controls
            text_color: white
            align: CENTER
            width: 320
            height: 180 #240-(2*30) #Display area less header & footer
            pad_all: 0
            bg_opa: TRANSP #COVER
            border_opa: TRANSP
            # outline_width: 1 #debug top check we fill available space
            layout: # enable the GRID layout for the children widgets
              type: GRID # split the rows and the columns proportionally
              grid_columns: [FR(1), FR(1)] # equal
              grid_rows: [FR(1), FR(1), FR(1), FR(1), FR(1), FR(1)] # like percents
              pad_row: 4
              pad_column: 8
            widgets:
              - label:
                  grid_cell_column_pos: 0 # place the widget in
                  grid_cell_row_pos: 0 # the corresponding cell
                  grid_cell_x_align: STRETCH
                  grid_cell_y_align: STRETCH
                  id: lbl_bmv_soc
              - label:
                  grid_cell_column_pos: 0 # place the widget in
                  grid_cell_row_pos: 1 # the corresponding cell
                  grid_cell_x_align: STRETCH
                  grid_cell_y_align: STRETCH
                  id: lbl_bmv_voltage
              - label:
                  grid_cell_column_pos: 0 # place the widget in
                  grid_cell_row_pos: 2 # the corresponding cell
                  grid_cell_x_align: STRETCH
                  grid_cell_y_align: STRETCH
                  id: lbl_bmv_startv
              - label:
                  grid_cell_column_pos: 0 # place the widget in
                  grid_cell_row_pos: 3 # the corresponding cell
                  grid_cell_x_align: STRETCH
                  grid_cell_y_align: STRETCH
                  id: lbl_bmv_current
              - label:
                  grid_cell_column_pos: 0 # place the widget in
                  grid_cell_row_pos: 4 # the corresponding cell
                  grid_cell_x_align: STRETCH
                  grid_cell_y_align: STRETCH
                  id: lbl_bmv_power
              - label:
                  grid_cell_column_pos: 0 # place the widget in
                  grid_cell_row_pos: 5 # the corresponding cell
                  grid_cell_x_align: STRETCH
                  grid_cell_y_align: STRETCH
                  id: lbl_bmv_alarm
              - label:
                  grid_cell_column_pos: 1 # place the widget in
                  grid_cell_row_pos: 0 # the corresponding cell
                  grid_cell_x_align: STRETCH
                  grid_cell_y_align: STRETCH
                  id: lbl_light_lux
              - label:
                  grid_cell_column_pos: 1 # place the widget in
                  grid_cell_row_pos: 1 # the corresponding cell
                  grid_cell_x_align: STRETCH
                  grid_cell_y_align: STRETCH
                  id: lbl_mppt_voltage
              - label:
                  grid_cell_column_pos: 1 # place the widget in
                  grid_cell_row_pos: 2 # the corresponding cell
                  grid_cell_x_align: STRETCH
                  grid_cell_y_align: STRETCH
                  id: lbl_mppt_panel_voltage
              - label:
                  grid_cell_column_pos: 1 # place the widget in
                  grid_cell_row_pos: 3 # the corresponding cell
                  grid_cell_x_align: STRETCH
                  grid_cell_y_align: STRETCH
                  id: lbl_mppt_current
              - label:
                  grid_cell_column_pos: 1 # place the widget in
                  grid_cell_row_pos: 4 # the corresponding cell
                  grid_cell_x_align: STRETCH
                  grid_cell_y_align: STRETCH
                  id: lbl_mppt_power
              - label:
                  grid_cell_column_pos: 1 # place the widget in
                  grid_cell_row_pos: 5 # the corresponding cell
                  grid_cell_x_align: STRETCH
                  grid_cell_y_align: STRETCH
                  id: lbl_mppt_state

#--------------------------------------------------------------------------
    - id: heating_page
      bg_color: 0x000000 #black
      widgets:
        - obj:
            align: TOP_MID
            styles: header_footer
            widgets:
              - label:
                  text: "Heating"
                  align: CENTER
                  text_align: CENTER
                  text_color: 0xFFFFFF #white
        - obj: # a properly placed coontainer object for all these controls
            text_color: white
            align: CENTER
            width: 320
            height: 180 #240-(2*30) #Display area less header & footer
            pad_all: 0
            bg_opa: TRANSP #COVER
            border_opa: TRANSP
            # outline_width: 1 #debug top check we fill available space
            layout: # enable the GRID layout for the children widgets
              type: GRID # split the rows and the columns proportionally
              grid_columns: [FR(1), FR(1)] # equal
              grid_rows: [FR(1), FR(1), FR(1), FR(1), FR(1), FR(1)] # like percents
              pad_row: 4
              pad_column: 8
            widgets:
              - bar:
                  grid_cell_column_pos: 0 # place the widget in
                  grid_cell_row_pos: 0 # the corresponding cell
                  grid_cell_x_align: STRETCH
                  grid_cell_y_align: STRETCH
                  id: bar_lounge_temp
                  value: 100
                  styles: bar_temperature
                  indicator: 
                    styles: indicator_temperature
              - label:
                  grid_cell_column_pos: 0 # place the widget in
                  grid_cell_row_pos: 0 # the corresponding cell
                  grid_cell_x_align: STRETCH
                  grid_cell_y_align: STRETCH
                  id: lbl_lounge_temp
                  text: "Lounge"
                  styles: lbl_temperature_humidity
              - bar:
                  grid_cell_column_pos: 0 # place the widget in
                  grid_cell_row_pos: 1 # the corresponding cell
                  grid_cell_x_align: STRETCH
                  grid_cell_y_align: STRETCH
                  id: bar_lounge_humidity
                  value: 100
                  styles: bar_temperature
                  indicator: 
                    styles: indicator_humidity
              - label:
                  grid_cell_column_pos: 0 # place the widget in
                  grid_cell_row_pos: 1 # the corresponding cell
                  grid_cell_x_align: STRETCH
                  grid_cell_y_align: STRETCH
                  id: lbl_lounge_humidity
                  text: "Lounge"
                  styles: lbl_temperature_humidity
              - bar:
                  grid_cell_column_pos: 1 # place the widget in
                  grid_cell_row_pos: 0 # the corresponding cell
                  grid_cell_x_align: STRETCH
                  grid_cell_y_align: STRETCH
                  id: bar_dining_temp
                  value: 100
                  styles: bar_temperature
                  indicator: 
                    styles: indicator_temperature
              - label:
                  grid_cell_column_pos: 1 # place the widget in
                  grid_cell_row_pos: 0 # the corresponding cell
                  grid_cell_x_align: STRETCH
                  grid_cell_y_align: STRETCH
                  id: lbl_dining_temp
                  text: "Dining"
                  styles: lbl_temperature_humidity
              - bar:
                  grid_cell_column_pos: 1 # place the widget in
                  grid_cell_row_pos: 1 # the corresponding cell
                  grid_cell_x_align: STRETCH
                  grid_cell_y_align: STRETCH
                  id: bar_dining_humidity
                  value: 100
                  styles: bar_temperature
                  indicator: 
                    styles: indicator_humidity
              - label:
                  grid_cell_column_pos: 1 # place the widget in
                  grid_cell_row_pos: 1 # the corresponding cell
                  grid_cell_x_align: STRETCH
                  grid_cell_y_align: STRETCH
                  id: lbl_dining_humidity
                  text: "Dining"
                  styles: lbl_temperature_humidity
              - bar:
                  grid_cell_column_pos: 0 # place the widget in
                  grid_cell_row_pos: 2 # the corresponding cell
                  grid_cell_x_align: STRETCH
                  grid_cell_y_align: STRETCH
                  id: bar_bedroom_temp
                  value: 100
                  styles: bar_temperature
                  indicator: 
                    styles: indicator_temperature
              - label:
                  grid_cell_column_pos: 0 # place the widget in
                  grid_cell_row_pos: 2 # the corresponding cell
                  grid_cell_x_align: STRETCH
                  grid_cell_y_align: STRETCH
                  id: lbl_bedroom_temp
                  text: "Bedroom"
                  styles: lbl_temperature_humidity
              - bar:
                  grid_cell_column_pos: 0 # place the widget in
                  grid_cell_row_pos: 3 # the corresponding cell
                  grid_cell_x_align: STRETCH
                  grid_cell_y_align: STRETCH
                  id: bar_bedroom_humidity
                  value: 100
                  styles: bar_temperature
                  indicator: 
                    styles: indicator_humidity
              - label:
                  grid_cell_column_pos: 0 # place the widget in
                  grid_cell_row_pos: 3 # the corresponding cell
                  grid_cell_x_align: STRETCH
                  grid_cell_y_align: STRETCH
                  id: lbl_bedroom_humidity
                  text: "Bedroom"
                  styles: lbl_temperature_humidity
              - bar:
                  grid_cell_column_pos: 1 # place the widget in
                  grid_cell_row_pos: 2 # the corresponding cell
                  grid_cell_x_align: STRETCH
                  grid_cell_y_align: STRETCH
                  id: bar_cupboard_temp
                  value: 100
                  styles: bar_temperature
                  indicator: 
                    styles: indicator_temperature
              - label:
                  grid_cell_column_pos: 1 # place the widget in
                  grid_cell_row_pos: 2 # the corresponding cell
                  grid_cell_x_align: STRETCH
                  grid_cell_y_align: STRETCH
                  id: lbl_cupboard_temp
                  text: "Cupboard"
                  styles: lbl_temperature_humidity
              - bar:
                  grid_cell_column_pos: 1 # place the widget in
                  grid_cell_row_pos: 3 # the corresponding cell
                  grid_cell_x_align: STRETCH
                  grid_cell_y_align: STRETCH
                  id: bar_cupboard_humidity
                  value: 100
                  styles: bar_temperature
                  indicator: 
                    styles: indicator_humidity
              - label:
                  grid_cell_column_pos: 1 # place the widget in
                  grid_cell_row_pos: 3 # the corresponding cell
                  grid_cell_x_align: STRETCH
                  grid_cell_y_align: STRETCH
                  id: lbl_cupboard_humidity
                  text: "Cupboard"
                  styles: lbl_temperature_humidity
              - bar:
                  grid_cell_column_pos: 0 # place the widget in
                  grid_cell_row_pos: 4 # the corresponding cell
                  grid_cell_x_align: STRETCH
                  grid_cell_y_align: STRETCH
                  id: bar_bathroom_temp
                  value: 100
                  styles: bar_temperature
                  indicator: 
                    styles: indicator_temperature
              - label:
                  grid_cell_column_pos: 0 # place the widget in
                  grid_cell_row_pos: 4 # the corresponding cell
                  grid_cell_x_align: STRETCH
                  grid_cell_y_align: STRETCH
                  id: lbl_bathroom_temp
                  text: "Bathroom"
                  styles: lbl_temperature_humidity
              - bar:
                  grid_cell_column_pos: 0 # place the widget in
                  grid_cell_row_pos: 5 # the corresponding cell
                  grid_cell_x_align: STRETCH
                  grid_cell_y_align: STRETCH
                  id: bar_bathroom_humidity
                  value: 100
                  styles: bar_temperature
                  indicator: 
                    styles: indicator_humidity
              - label:
                  grid_cell_column_pos: 0 # place the widget in
                  grid_cell_row_pos: 5 # the corresponding cell
                  grid_cell_x_align: STRETCH
                  grid_cell_y_align: STRETCH
                  id: lbl_bathroom_humidity
                  text: "Bathroom"
                  styles: lbl_temperature_humidity
       
#--------------------------------------------------------------------------
    - id: relay_page
      bg_color: 0x000000 #black
      widgets:
        - obj:
            align: TOP_MID
            styles: header_footer
            widgets:
              - label:
                  text: "Relay Control"
                  align: CENTER
                  text_align: CENTER
                  text_color: 0xFFFFFF #white
        - obj: # a properly placed coontainer object for all these controls
            text_color: white
            align: CENTER
            width: 320
            height: 180 #240-(2*30) #Display area less header & footer
            pad_all: 0
            bg_opa: TRANSP #COVER
            border_opa: TRANSP
            # outline_width: 1 #debug top check we fill available space
            layout: # enable the GRID layout for the children widgets
              type: GRID # split the rows and the columns proportionally
              grid_columns: [FR(1), FR(1)] # equal
              grid_rows: [FR(1), FR(1), FR(1), FR(1), FR(1), FR(1)] # like percents
              pad_row: 4
              pad_column: 8
            widgets:
              - button:
                  grid_cell_column_pos: 0 # place the widget in
                  grid_cell_row_pos: 0 # the corresponding cell
                  grid_cell_column_span: 2 #Span 2 columns
                  grid_cell_row_span: 1 #Span 2 rows
                  grid_cell_x_align: STRETCH
                  grid_cell_y_align: STRETCH
                  id: btn_relay_1
                  checkable: true
                  checked:
                    bg_color: red
                    text_color: black
                    bg_grad_dir: NONE
                  widgets:
                    - label:
                        align: center
                        text: "Relay 1"
                  on_change:
                    then:
                      - switch.toggle:
                          id: relay_1
              - button:
                  grid_cell_column_pos: 0 # place the widget in
                  grid_cell_row_pos: 1 # the corresponding cell
                  grid_cell_column_span: 2 #Span 2 columns
                  grid_cell_row_span: 1 #Span 2 rows
                  grid_cell_x_align: STRETCH
                  grid_cell_y_align: STRETCH
                  id: btn_relay_2
                  checkable: true
                  checked:
                    bg_color: red
                    text_color: black
                    bg_grad_dir: NONE
                  widgets:
                    - label:
                        align: center
                        text: "Relay 2"
                  on_change:
                    then:
                      - switch.toggle:
                          id: relay_2
              - button:
                  grid_cell_column_pos: 0 # place the widget in
                  grid_cell_row_pos: 2 # the corresponding cell
                  grid_cell_column_span: 2 #Span 2 columns
                  grid_cell_row_span: 1 #Span 2 rows
                  grid_cell_x_align: STRETCH
                  grid_cell_y_align: STRETCH
                  id: btn_relay_3
                  checkable: true
                  checked:
                    bg_color: red
                    text_color: black
                    bg_grad_dir: NONE
                  widgets:
                    - label:
                        align: center
                        text: "Relay 3"
                  on_change:
                    then:
                      - switch.toggle:
                          id: relay_3
              - button:
                  grid_cell_column_pos: 0 # place the widget in
                  grid_cell_row_pos: 3 # the corresponding cell
                  grid_cell_column_span: 2 #Span 2 columns
                  grid_cell_row_span: 1 #Span 2 rows
                  grid_cell_x_align: STRETCH
                  grid_cell_y_align: STRETCH
                  id: btn_relay_4
                  checkable: true
                  checked:
                    bg_color: red
                    text_color: black
                    bg_grad_dir: NONE
                  widgets:
                    - label:
                        align: center
                        text: "Relay 4"
                  on_change:
                    then:
                      - switch.toggle:
                          id: relay_4
              - button:
                  grid_cell_column_pos: 0 # place the widget in
                  grid_cell_row_pos: 4 # the corresponding cell
                  grid_cell_column_span: 2 #Span 2 columns
                  grid_cell_row_span: 1 #Span 2 rows
                  grid_cell_x_align: STRETCH
                  grid_cell_y_align: STRETCH
                  id: btn_relay_5
                  checkable: true
                  checked:
                    bg_color: red
                    text_color: black
                    bg_grad_dir: NONE
                  widgets:
                    - label:
                        align: center
                        text: "Relay 5"
                  on_change:
                    then:
                      - switch.toggle:
                          id: relay_5
              - button:
                  grid_cell_column_pos: 0 # place the widget in
                  grid_cell_row_pos: 5 # the corresponding cell
                  grid_cell_column_span: 2 #Span 2 columns
                  grid_cell_row_span: 1 #Span 2 rows
                  grid_cell_x_align: STRETCH
                  grid_cell_y_align: STRETCH
                  id: btn_relay_6
                  checkable: true
                  checked:
                    bg_color: red
                    text_color: black
                    bg_grad_dir: NONE
                  widgets:
                    - label:
                        align: center
                        text: "Relay 6"
                  on_change:
                    then:
                      - switch.toggle:
                          id: relay_6
      
#==========================================================================================================================
    - id: ota_page
      bg_color: PURPLE
      hidden: true #start hidden unless an ota is triggered
      widgets:
        - obj:
            align: TOP_MID
            styles: header_footer
            widgets:
              - label:
                  text: "Firmware Update"
                  align: CENTER
                  text_align: CENTER
                  text_color: 0xFFFFFF
        - bar:
            x: 50
            y: 100
            width: 220
            id: bar_ota_progress
            value: 1
            min_value: 0
            max_value: 100 #OTA progress
        - label:
            x: 50
            y: 50
            text_font: montserrat_28 # Bigger text
            id: lbl_ota_source
            text: "OTA"
        
#==========================================================================================================================
